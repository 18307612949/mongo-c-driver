<section id="count" xmlns="http://projectmallard.org/1.0/">
  <info>
    <link type="guide" xref="tutorial#crud-operations"/>
    <link type="guide" xref="mongoc_collection_count"/>
  </info>

  <title>Counting Documents</title>
  <p>Counting the number of documents in a MongoDB collection is similar to performing a <link xref="tutorial#find">find operation</link>. This example counts the number of documents matching <code mime="text/x-json">{"hello" : "world"}</code> in the database "mydb" and collection "mycoll".</p>

  <listing>
    <title><file>example9.c</file></title>
    <synopsis><code mime="text/x-csrc"><![CDATA[#include <bson.h>
#include <mongoc.h>
#include <stdio.h>

int
main (int   argc,
      char *argv[])
{
   mongoc_client_t *client;
   mongoc_collection_t *collection;
   bson_error_t error;
   bson_oid_t oid;
   bson_t *doc;
   char *str;
   int64_t count;

   mongoc_init ();

   client = mongoc_client_new ("mongodb://localhost:27017/");
   collection = mongoc_client_get_collection (client, "mydb", "mycoll");
   doc = bson_new_from_json ("{\"hello\" : \"world\"}");

   count = mongoc_collection_count (collection, MONGOC_QUERY_NONE, doc, 0, 0, NULL, &error);

   if (count < 0) {
      str = bson_as_json (&error, NULL);
      fprintf (stderr, "%s\n", str);
      bson_free (str);
   } else {
      fprintf (stdout, "%" PRIu64 "\n", count);
   }

   bson_destroy (doc);
   mongoc_collection_destroy (collection);
   mongoc_client_destroy (client);

   return 0;
}
]]></code></synopsis>
  </listing>

  <p>Compile the code and run it: </p>
  <screen><output style="prompt">$ gcc -o example9 example9.c $(pkg-config --cflags --libs libmongoc-1.0)
$ ./example9
1</output></screen>
</section>
